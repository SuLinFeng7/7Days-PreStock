# 智能股票预测系统 (Stock Price Prediction System)

基于多种深度学习模型的股票价格预测系统，支持 A 股和美股的未来 30 天股价预测。

## 功能特点

- 支持多个市场的股票预测（A 股和美股）
- 集成三种深度学习模型（LSTM、CNN、Transformer）
- 提供最长 30 天的未来股价预测
- 可配置 1-10 年的历史数据训练
- 自动生成预测报告和可视化图表
- 提供模型性能评估指标（MAPE、RMSE、MAE）
- 直观的图形用户界面

## 预置股票

系统预置了以下新能源汽车相关股票：

- A 股：
  - 600104.SH (上汽集团)
  - 002594.SZ (比亚迪)
  - 601127.SH (赛力斯)
  - 600006.SH (长城汽车)
  - 601633.SH (广汽集团)
  - 300750.SZ (宁德时代)
- 美股：
  - TSLA (特斯拉)
  - LI (理想汽车)
  - NIO (蔚来汽车)
  - XPEV (小鹏汽车)

## 系统要求

- Python 3.8+
- Windows 10/11

## 依赖安装

主要依赖包：

- tushare >= 1.2.89 (A 股数据源)
- pandas >= 1.3.0
- numpy >= 1.19.5
- scikit-learn >= 0.24.2
- tensorflow >= 2.6.0
- torch >= 1.9.0
- matplotlib >= 3.4.3
- pyecharts >= 2.0.0
- tkcalendar
- ttkthemes >= 3.2.2

## 使用说明

1. 启动系统：
   bash
   python app/main.py

2. 在界面中选择：

   - 股票代码（可从预置列表选择或手动输入）
   - 训练年限（1-10 年）
   - 预测起始日期
   - 预测结束日期（最多预测 30 天）

3. 点击"开始预测"按钮开始训练和预测

4. 系统将自动：
   - 获取历史数据
   - 训练三个深度学习模型
   - 生成预测结果
   - 保存分析报告

## 输出文件

预测结果将保存在 `record/{股票代码}_{日期}` 目录下：

1. `prediction_results.xlsx`：包含四个工作表

   - 未来预测结果：30 天的预测数据
   - 历史预测结果：模型在历史数据上的表现
   - 评估指标：各模型的 MAPE、RMSE、MAE 指标
   - 模型配置：各模型的参数配置

2. `images/` 目录：
   - `historical_comparison.png`：历史预测对比图
   - `future_prediction.png`：未来预测趋势图
   - `metrics_comparison.png`：模型评估指标对比图

## 模型说明

系统集成了三种深度学习模型：

1. LSTM 模型

   - 适合捕捉长期依赖关系
   - 3 层 LSTM 结构
   - 64 维隐藏层

2. CNN 模型

   - 适合捕捉局部特征
   - 支持早停和学习率自适应

3. Transformer 模型
   - 基于注意力机制
   - 支持并行计算
   - 4 头注意力机制

## 技术特点

- 多维度技术指标：MA、RSI、MACD、KDJ 等
- 自动化数据预处理和特征工程
- 模型集成预测
- 实时训练进度显示
- 中文界面支持

## 注意事项

1. 首次使用需要配置 Tushare Token（用于获取 A 股数据）
2. 预测时长建议不超过 30 天
3. 建议使用 10 年训练数据以获得最佳效果
4. 预测结果仅供参考，投资需谨慎

## 许可证

MIT License
